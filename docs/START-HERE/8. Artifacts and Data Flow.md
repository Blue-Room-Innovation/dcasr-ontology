We will extend what was discussed in [[3. Configuration]].

---

## Global Data-Flow Overview

```text
OWL Ontologies (.ttl)
        ‚îÇ
        ‚ñº
Merged Ontology / Reasoned
        ‚îÇ
        ‚ñº
SHACL Shapes
        ‚îÇ
        ‚îú‚îÄ SHACL Validation (examples)
        ‚îÇ
        ‚îú‚îÄ JSON Schema
        ‚îÇ        ‚îÇ
        ‚îÇ        ‚îî‚îÄ TypeScript Definitions
        ‚îÇ
        ‚îî‚îÄ Wiki Documentation
```

**Final result**:

- Semantic validation (OWL + SHACL)
- Data contracts (JSON Schema)
- Strong typing for developers (TypeScript)
- Human-readable documentation (Wiki)

---

## Component Versioning

Each pipeline component has **explicit and independent versioning**, enabling:

- Controlled evolution
- Parallel builds
- Backward compatibility

```yaml
ontology_version: "v0.1" # Semantic model (OWL)
shapes_version: "v0.1" # Validation rules (SHACL)
examples_version: "v0.1" # Test data
codelists_version: "v0.1" # Controlled vocabularies
```

**No script should assume versions**: everything is resolved from here.

---

## Build Version

```yaml
build_version: "v0.1"
```

Defines **where all generated artifacts are stored**:

```text
build/v0.1/
‚îú‚îÄ *.schema.json      ‚Üê Data contracts
‚îú‚îÄ *.ts               ‚Üê TypeScript types
‚îú‚îÄ merged-ontology.ttl
‚îî‚îÄ reasoned-ontology.ttl
```

---

## Ontologies (Semantic Input)

This block defines **which ontologies enter the system**.

```yaml
ontologies:
  - name: "digitalWastePassport"
    file: "digitalWastePassport.ttl"
    display_name: "Digital Waste Passport"
    description: "Core waste passport ontology"
```

Used for:

- Semantic merging
- OWL reasoning
- Conceptual documentation

---

## SHACL Shapes (Validation Rules)

They define **how data must be validated** based on the ontologies.

```yaml
shapes:
  - name: "digitalWastePassport"
    file: "digital-waste-passport.shacl.ttl"
    ontology: "digitalWastePassport"
```

üìå **SHACL is the key bridge** between:

- Semantic model (OWL)
- Technical contracts (JSON Schema)

---

## Artifact Generation Pipeline

```yaml
generation:
  artifacts:
    - dwp
    - dmwp
    - recycling
```

Each artifact represents **a complete flow**:

```text
SHACL
 ‚îú‚îÄ JSON Schema
 ‚îÇ     ‚îî‚îÄ TypeScript
 ‚îî‚îÄ Wiki Docs
```

---

## Validation

### OWL Validation (Model)

```yaml
owl:
  reasoner: "HermiT"
  profile: "DL"
  include_codelists: true
```

Result:

- `merged-ontology.ttl`
- `reasoned-ontology.ttl`

Ensures semantic consistency before moving down to the data level.

---

### SHACL Validation (Data)

Each scenario is **executable via the CLI**:

```bash
npm run validate:shacl dwp
```

```yaml
validation:
  shacl:
    scenarios:
      dwp:
        data: "examples/v0.1/digital-waste-passport-sample.ttl"
        shapes: "shapes/v0.1/digital-waste-passport.shacl.ttl"
```

Goal: ensure that data **strictly complies with the model**.

---

## Artifact Conversion

### SHACL ‚Üí JSON Schema

Result:

- Validation contracts
- OpenAPI
- Frontend / backend validation

---

### JSON Schema ‚Üí TypeScript

Result:

- Strong typing
- Improved developer experience (DX)
- Zero drift between model and code

---

## Wiki Documentation

Generates:

- Classes
- Properties
- Relationships
- SHACL constraints
- Diagrams

Designed for:

- Stakeholders
- Onboarding
- Governance

Output location:

- The wiki output directory is configured in `config.yml` under `wiki.output_dir`.
- By default it is written to `build/<build_version>/wiki` so it can be published together with versioned artifacts.

---

## Publication indexes (GitHub Pages)

To make versioned folders browsable on GitHub Pages, the build pipeline generates Markdown indexes.

- `build/index.md` links to versioned build folders and to the wiki.
- `build/<version>/index.md` links to per-file artifacts and to the ontology/shapes sources.

If `repository.pages_url` is set in `config.yml`, these indexes contain absolute URLs to the published domain.

---

## Releases and Governance

```yaml
release:
  versioning:
    major: "Breaking changes"
    minor: "New features"
    patch: "Bug fixes"
```

Clear separation:

- **Codelists** ‚Üí independent release
- **Ontologies + Shapes + Examples** ‚Üí synchronized release

---

## Summary

Ontology = semantic truth
SHACL = data contract
JSON Schema = technical interface
TypeScript = application consumption
Wiki = human understanding

All of this is **orchestrated by a single configuration file**: `config.yml`
